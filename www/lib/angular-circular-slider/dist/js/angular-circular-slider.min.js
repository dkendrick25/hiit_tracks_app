/*!The MIT License (MIT)

Copyright (c) 2015 Prince John Wesley (princejohnwesley@gmail.com)
**/
!function(a,b,c){function d(a){return(0|a)===a}function e(){return!0}function f(c){function d(a){return function(){return o[a]}}function e(a){return n[a]}function g(a){return function(){return e(a)}}function h(a){return parseFloat(a)||0}function i(a,b){return function(){return h(a())+h(b())}}function j(a){return function(b){return h(a(b))}}function k(){return b.element(n.offsetParent)}function l(){var a=n.getBoundingClientRect(),b=n.ownerDocument.documentElement;return{top:a.top+b.scrollTop-b.clientTop,left:a.left+b.scrollLeft-b.clientLeft}}function m(){var a=l(),b=k();if(!b.length)return{top:a.top-h(c.css("marginTop"))+h(c.css("borderTopWidth")),left:a.left-h(c.css("marginLeft"))+h(c.css("borderLeftWidth"))};var d=f(b),e=d.offset();return e.top+=h(d.css("borderTopWidth")),e.left+=h(d.css("borderLeftWidth")),{top:a.top-e.top-h(c.css("marginTop")),left:a.left-e.left-h(c.css("marginLeft"))}}var n=c[0],o=a.getComputedStyle(n,null);return{css:c.css,prop:e,width:j(d("width")),height:j(d("height")),outerWidth:i(i(g("offsetWidth"),d("marginLeft")),d("marginRight")),outerHeight:i(i(g("offsetHeight"),d("marginTop")),d("marginBottom")),innerWidth:i(i(d("width"),d("paddingLeft")),d("paddingRight")),innerHeight:i(i(d("height"),d("paddingTop")),d("paddingBottom")),offset:l,offsetParent:k,position:m}}function g(){function c(c,d,e,g,h){function j(){var a=n(),e=o();p[c.shape].drawShape(a,e),m(a,e);var g=f(a.acs),h=f(a.acsIndicator);q.acsPosition=g.position(),q.acsRadius=g.width()/2,q.acsBallRadius=h.width()/2,q.acsCenter=p[c.shape].getCenter(q.acsPosition,q.acsRadius),c.selectable?a.acsPanel.removeClass("noselect"):a.acsPanel.addClass("noselect"),c.touch&&k(),b.forEach(["mouseup","mousedown","mousemove","mouseleave","click"],function(a){d.on(a,r[a])}),l("number"==typeof c.value?c.value:c.min)}function k(){b.forEach(["touchstart","touchmove","touchend","touchcancel"],function(a){d.on(a,r.touch)})}function l(a){g.validateBinding("value");var b=c.clockwise?a:c.max-a,d=p[c.shape].val2Deg(b),e=d*Math.PI/180,f=n(),h=f.scope.borderWidth+q.acsBallRadius,i=q.acsCenter.x+q.acsCenter.r*c.handleDistRatio*Math.cos(e)-h,j=q.acsCenter.y+q.acsCenter.r*c.handleDistRatio*Math.sin(e)-h;f.acsIndicator.css("top",j+"px"),f.acsIndicator.css("left",i+"px"),c.value=c.$$value=a,"function"==typeof c.onSlide&&c.onSlide(a)}function m(a,b){a.acsIndicator.css({width:b*c.indicatorBallRatio+"px",height:b*c.indicatorBallRatio+"px"})}function n(){var a=d.children(),e=a.children(),f=b.element(e[0]),h=b.element(e[1]),i=f.children(),j={acsPanel:a,acs:f,acsIndicator:h,acsValue:i,scope:c,ctrl:g};return q.components=j}function o(){return Math.abs(parseInt(c.radius))||i.defaults.radius}var p={Circle:{drawShape:function(a,b){var c=2*b,d=c+"px",e=a.acs,g=a.acsValue,h=a.acsPanel,i=a.scope,j=i.borderWidth;e.css({width:d,height:d,"border-radius":d,"border-width":j+"px"});var k=c+j;h.css({"border-width":j+"px","border-radius":k+"px"});var l=f(e),m=f(g),n=i.innerCircleRatio*b;g.css({width:2*n+"px",height:2*n+"px","font-size":n/2+"px"});var o=b-n;g.css({top:o-l.prop("clientTop")-m.prop("clientTop")+"px",left:o-l.prop("clientLeft")-m.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+b,y:a.top+b,r:b}},deg2Val:function(a){var b=q.components.scope,c=b.max-b.min+1;if(a<0||a>359)throw"Invalid angle "+a;return a=(a+90)%360,Math.round(a*(c/360))+b.min},val2Deg:function(a){var b=q.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(360/c))-90)%360}},"Half Circle":{drawShape:function(a,b){var c=2*b,d=a.acs,e=a.acsValue,g=a.acsPanel,h=a.scope,i=h.borderWidth;d.css({width:c+"px",height:b+"px","border-radius":c+"px "+c+"px 0 0","border-bottom":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":j+"px "+j+"px 0 0","border-bottom":"none"});var k=f(d),l=f(e),m=h.innerCircleRatio*b;e.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;e.css({top:n-k.prop("clientTop")-l.prop("clientTop")+"px",left:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+b,y:a.top+b,r:b}},deg2Val:function(a){var b=q.components.scope,c=b.max-b.min+1;if(a<0||a>359)throw"Invalid angle "+a;return a=(a+180)%360,Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=q.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(180/c))-180)%360}},"Half Circle Left":{drawShape:function(a,b){var c=2*b,d=a.acs,e=a.acsValue,g=a.acsPanel,h=a.scope,i=h.borderWidth;d.css({height:c+"px",width:b+"px","border-radius":c+"px 0 0 "+c+"px","border-right":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":j+"px 0 0"+j+"px","border-right":"none"});var k=f(d),l=f(e),m=h.innerCircleRatio*b;e.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;e.css({top:n-k.prop("clientTop")-l.prop("clientTop")+"px",left:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+2*b,y:a.top+2*b,r:2*b}},deg2Val:function(a){var b=q.components.scope,c=b.max-b.min+1;if(a<0||a>359)throw"Invalid angle "+a;return a=(a-90)%360,Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=q.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(180/c))+90)%360}},"Half Circle Right":{drawShape:function(a,b){var c=2*b,d=a.acs,e=a.acsValue,g=a.acsPanel,h=a.scope,i=h.borderWidth;d.css({height:c+"px",width:b+"px","border-radius":"0 "+c+"px "+c+"px 0","border-left":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":"0 "+j+"px"+j+"px 0","border-left":"none"});var k=f(d),l=f(e),m=h.innerCircleRatio*b;e.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;e.css({top:n-k.prop("clientTop")-l.prop("clientTop")+"px",right:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left,y:a.top+2*b,r:2*b}},deg2Val:function(a){var b=q.components.scope,c=b.max-b.min+1;if(a<0||a>359)throw"Invalid angle "+a;return a=(a+90)%360,Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=q.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(180/c))-90)%360}},"Half Circle Bottom":{drawShape:function(a,b){var c=2*b,d=a.acs,e=a.acsValue,g=a.acsPanel,h=a.scope,i=h.borderWidth;d.css({width:c+"px",height:b+"px","border-radius":"0 0 "+c+"px "+c+"px","border-top":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":"0 0 "+j+"px "+j+"px","border-top":"none"});var k=f(d),l=f(e),m=h.innerCircleRatio*b;e.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;e.css({bottom:n-k.prop("clientTop")-l.prop("clientTop")+"px",left:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+b,y:a.top,r:b}},deg2Val:function(a){var b=q.components.scope,c=b.max-b.min+1;if(a<0||a>359)throw"Invalid angle "+a;return Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=q.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return Math.round(d*(180/c))}}},q={},r=function(){function c(){var a=q.components.scope;"function"==typeof a.onSlideEnd&&a.onSlideEnd(a.value)}var d=!1,e=!1,g="",h=function(c){var d=c.changedTouches;if(!(d.length>1)){var e=d[0],h=b.element(e.target);if(h.hasClass("acs")){var i=f(h),j=i.offset(),k=i.width(),l=i.height(),m=e.clientX,n=e.clientY;if(!(m<j.left||m>k+j.left||n<j.top||n>l+j.top)){var o=["touchstart","touchmove","touchend","touchcancel"],p=["mousedown","mousemove","mouseup","mouseleave"],q=o.indexOf(c.type);if(q!==-1){var r=p[q];c.type===o[2]&&g===o[0]&&(r="click");var s=document.createEvent("MouseEvent");s.initMouseEvent(r,!0,!0,a,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(s),c.preventDefault(),g=c.type}}}}},i=function(b){var d={x:b.offsetX||b.layerX,y:b.offsetY||b.layerY},f=d.x-q.acsCenter.x,g=d.y-q.acsCenter.y,h=Math.atan2(g,f),i=180*h/Math.PI,j=parseInt(i<0?360+i:i)%360,k=q.components.scope,l=k.borderWidth+q.acsBallRadius,m=(q.acsCenter.x+q.acsCenter.r*k.handleDistRatio*Math.cos(h)-l,q.acsCenter.y+q.acsCenter.r*k.handleDistRatio*Math.sin(h)-l,(p[k.shape].val2Deg(k.value)+360)%360);if(m!==j){var n=Math.min((j+360-m)%360,(m+360-j)%360);n||(n=180);var o=(j+360-m)%360===n,r=k.animateDuration/n,s=4,t=1;r>=4?s=parseInt(r):t=r>=1?4*parseInt(r):4/r;var u=m,v=parseInt(n/t);e=!0;var w=function(){u+=o?t:-t,u=(u+360)%360,--v<=0&&(clearInterval(x),e=!1,u=j),q.funs.setValue(p[k.shape].deg2Val(u)),k.$apply(),e||c()},x=a.setInterval(w,s)}},j=function(a){if(a.stopPropagation(),d&&!e){var b={x:a.offsetX||a.layerX,y:a.offsetY||a.layerY},c=b.x-q.acsCenter.x,f=b.y-q.acsCenter.y,g=Math.atan2(f,c),h=180*g/Math.PI,i=parseInt(h<0?360+h:h)%360,j=q.components.scope,k=j.borderWidth+q.acsBallRadius,l=q.acsCenter.x+q.acsCenter.r*j.handleDistRatio*Math.cos(g)-k,m=q.acsCenter.y+q.acsCenter.r*j.handleDistRatio*Math.sin(g)-k;q.components.acsIndicator.css("top",m+"px"),q.components.acsIndicator.css("left",l+"px");var n=p[j.shape].deg2Val(i),o=j.clockwise?n:j.max-n;o<j.min?o=j.min:o>j.max&&(o=j.max),j.value=j.$$value=o,j.onSlide(o),j.$apply()}},k=function(a){q.components.scope.disabled||(d=!0,a.stopPropagation())},l=function(a){q.components.scope.disabled||(d=!1,a.stopPropagation())},m=function(a){if(!q.components.scope.disabled){a.stopPropagation();var b={x:a.offsetX||a.layerX,y:a.offsetY||a.layerY},e=b.x-q.acsCenter.x,f=b.y-q.acsCenter.y,g=q.components.scope,h=Math.sqrt(e*e+f*f);q.acsRadius-h<=.1*q.acsRadius||h>q.acsRadius?g.animate?i(a):(d=!0,j(a),c()):c(),d=!1}};return{touch:h,mousemove:j,mousedown:k,mouseup:l,mouseleave:l,click:m}}();b.isUndefined(c.value)&&(c.value=c.min),b.forEach(c.$$isolateBindings,function(a,d){b.isUndefined(c[d])&&(c[d]=i.defaults[d])}),g.validateBindings(),d.addClass("acs-slider"),j(),q.funs={setValue:l},h(c,function(a){b.element(d[0].getElementsByClassName("acs-value")).empty().append(a)}),c.$watch(function(){return d[0].offsetParent},function(a,b){b!==a&&j()}),c.$watch("value",function(a){if(d[0].offsetParent&&!q.components.scope.disabled&&a!==c.$$value)try{q.funs.setValue(a)}catch(b){throw c.value=c.$$value,b}})}return{template:i.template,restrict:"EA",transclude:!0,controller:h,controllerAs:"slider",scope:{min:"=?",max:"=?",value:"=?",radius:"=?",innerCircleRatio:"=?",indicatorBallRatio:"=?",handleDistRatio:"=?",borderWidth:"=?",clockwise:"=?",shape:"@?",touch:"=?",animate:"=?",animateDuration:"=?",selectable:"=?",disabled:"=?",onSlide:"=",onSlideEnd:"="},link:c}}function h(a){function c(a){return function(b,c){return[b,"(",c,") - Expected",a].join(" ")}}function f(a){b.forEach(i,function(c,d){b.forEach(c,function(b,c){var d=b.bindings;d.map(function(c){a[c]=a[c]||{tests:[]},a[c].tests.push({test:b.test,onError:b.onError})})})}),b.forEach(h,function(c){b.forEach(c.bindings,function(b){a[b].transform=c.transform})})}var g=["Circle","Half Circle","Half Circle Left","Half Circle Right","Half Circle Bottom"],h={integer:{bindings:["min","max","value","radius","animateDuration","borderWidth"],transform:parseInt},number:{bindings:["innerCircleRatio","indicatorBallRatio","handleDistRatio"],transform:parseFloat},"boolean":{bindings:["touch","animate","selectable","clockwise","disabled"],transform:function(a){return"true"===a||a===!0}},"function":{bindings:["onSlide","onSlideEnd"],transform:function(a){return a?a:b.noop}}},i={type:{integer:{bindings:["min","max","value","radius","animateDuration","borderWidth"],test:d,onError:c("integer")},number:{bindings:["innerCircleRatio","indicatorBallRatio","handleDistRatio"],test:isFinite,onError:c("number")},"boolean":{bindings:["touch","animate","selectable","clockwise","disabled"],test:e,onError:c("boolean")},"function":{bindings:["onSlide","onSlideEnd"],test:b.isFunction,onError:c("function")}},constraint:{range:{bindings:["min","max"],test:function(){return a.min<=a.max},onError:function(){return["Invalid slide range: [",a.min,",",a.max,"]"].join("")}},value:{bindings:["value"],test:function(b){return a.min<=b&&b<=a.max},onError:function(){return[a.value,"(value) out of range: [",a.min,",",a.max,"]"].join("")}},shape:{bindings:["shape"],test:function(){return g.indexOf(a.shape)!==-1},onError:function(){return["Unsupported shape: ",a.shape].join("")}},ratio:{bindings:["innerCircleRatio","handleDistRatio","indicatorBallRatio"],test:function(a){return a>=0&&a<=1},onError:function(a,b){return[a+"(",b,") is out of range: [0,1]"].join("")}}}};this.validateBindings=function(b){var c,d=b?b:this.props;for(c in d)d[c].transform&&(a[c]=d[c].transform(a[c])),d[c].tests.forEach(function(b){if(!b.test(a[c]))throw b.onError(c,a[c])})},this.validateBinding=function(a){if(!b.isUndefined(a)){var c={};c[a]=this.props[a],this.validateBindings(c)}},f(this.props={})}var i={defaults:{min:0,max:359,value:0,radius:75,innerCircleRatio:.5,borderWidth:1,indicatorBallRatio:.2,handleDistRatio:1,clockwise:!0,shape:"Circle",touch:!0,animate:!0,animateDuration:360,selectable:!1,disabled:!1,onSlide:b.noop,onSlideEnd:b.noop},template:'      <div class="acs-panel">        <div class="acs">          <div class="acs-value" ng-transclude>          </div>        </div>        <div class="acs-indicator">        </div>      </div>    '};h.$inject=["$scope"],b.module("angular.circular-slider",[]).directive("circularSlider",g)}(window,window.angular);